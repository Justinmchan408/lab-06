---
title: "lab-06: Model Selection + Diagnostics"
author: "Justin Chan"
date: "2/21/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Packages

Loading required packages for the lab:
```{r packages, echo=TRUE, message=FALSE, warning=FALSE}
library(tidyverse)
library(knitr)
library(broom)
library(leaps)
library(rms)
library(Sleuth3)
```

## Exercises

### Part I: Model Selection

We begin this lab by conducting model selection with various selection criteria to choose a final model from the SAT dataset. The code to load the data and create the full main effects model is shown below. The next few questions will walk you through backward model selection using different model selection criteria to select a model.

```{r dataset, include=TRUE}
sat_scores <- Sleuth3::case1201

full_model <- lm(SAT ~ Takers + Income + Years + Public + Expend + Rank, data = sat_scores)
tidy(full_model)
```

1. We will use the regsubsets function in the leaps R package to perform backward selection on multiple linear regression models with Adj.R2 or BIC as the selection criteria.

```{r regsubsets, include=TRUE}
model_select <- regsubsets(SAT ~ Takers + Income + Years + Public + Expend + Rank , data = sat_scores, method = "backward")
select_summary <- summary(model_select)
select_summary$adjr2
```

2. Fill in the code below to display the model selected from backward selection with BIC as the selection criterion.
```{r bic, include=TRUE}
select_summary$bic
```

3. Next, letâ€™s select a model using AIC as the selection criterion. To select a model using AIC, we will use the step function in R. The code below is to conduct backward selection using AIC as the criterion and store the selected model in an object called model_select_aic. Use the tidy function to display the coefficients of the selected model.

```{r aic, include=TRUE}
model_select_aic <- step(full_model, direction = "backward")
tidy(model_select_aic)
```

4 Compare the final models selected by Adj.R2, AIC, and BIC.













